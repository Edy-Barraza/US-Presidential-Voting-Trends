<!DOCTYPE html>

<html>

<head>
	<meta charset="UTF-8">
	<title> US Presidential Voting Trends</title>
	<script src="https://d3js.org/d3.v4.min.js"></script>

</head>
<style >
body {
        font-family: 'Avenir';
      }
.grid line {
  stroke: lightgrey;
  stroke-opacity: 0.7;
  shape-rendering: crispEdges;
  border: dotted;
}

	
</style>

<body>
  <h1>
    US Presidential Voting Trends
  </h1>



    <!--NOTE: Standard Map Size; Work In Progress -->
    <svg height="1400" width="1100">

    </svg>




</body>
<script >

//Voting by Demographic Line Chart
var votingData;

d3.json("votingbydemographic.json", function (error, data) {
  votingData = data;
  var padding=100; var width=1100; var height=800;
d3.select("body").append("svg").attr("id","lineGraph").attr("width", width).attr("height", height);

var svg= d3.select("#lineGraph");
var years=[1980,1984,1988,1992,1996,2000,2004,2008,2012,2016];
var yearScale=d3.scaleLinear()
  .domain([1980,2016])
  .range([padding, width-padding]);
var voteScale=d3.scaleLinear()
  .domain([20, 70])
  .range([height-padding, padding]);
//Axes
var xAxis=d3.axisBottom(yearScale).tickValues(years)
.tickFormat(d3.format("d"));
  svg.append("g")
  .attr("transform","translate(0,700)")
  .call(xAxis);
var yAxis=d3.axisLeft(voteScale)
  svg.append("g")
  .attr("transform","translate(100,0)")
  .call(yAxis);  
svg.append("text")
	//.attr("transform", "rotate(-90)")
	.text("Voting Rate (%)")
	.attr("x",padding/2)
  	.attr("y", height/2)
  	.attr("fill","black")
  	.style("font-size", "17px")
  	.attr('transform', 'translate(-350,500)rotate(-90)');
  	
 svg.append("text")
	.text("Year")
	.attr("x",width/2)
  	.attr("y", height-padding/2)
  	.style("font-size", "17px")
  	.attr("fill","black");
 svg.append("text")
	.text("Voting Rates in Presidential Election Years by Race")
	.attr("x",padding)
  	.attr("y", padding/2)
  	.style("font-size", "34px")
  	.attr("fill","black");


//grids
// gridScale=d3.scaleLinear()
//   .domain([25, 65])
//   .range([height-padding, padding]);
// gridlines in y axis function
function make_y_gridlines() {		
    return d3.axisLeft(voteScale)
}

// add the Y gridlines
  svg.append("g")			
      .attr("class", "grid")
      .attr("transform", "translate("+padding+",0)")
      .call(make_y_gridlines()
          .tickSize(-width)
          .tickFormat("")
      )

svg.append("line")
.attr("x1", padding+1)
.attr("x2", width)
.attr("y1", padding)
.attr("y2", padding)
.attr("stroke", "white")
.attr("stroke-width", 3)

pathWhite=[]; pathWhiteNH=[]; pathBlack=[]; pathAsian=[]; 
pathHispanic=[];
  years.forEach(function(y,i){
	var total=votingData.Total[y];
	console.log(total);
	var white=votingData.White[y]*Math.pow(10,5)/total;//#113777
	console.log(white);
	var whitenh=(votingData.WhiteNH[y]*Math.pow(10,5))/total; //#428ff4
	var black=(votingData.Black[y]*Math.pow(10,5))/total;//#771616
	var asian=votingData.Asian[y];
	if(asian!="(NA)"){
	 asian=(votingData.Asian[y]*Math.pow(10,5))/total;//#ba2121
	 pathAsian.push({x:yearScale(y),y: voteScale(asian)});
	}
	var hispanic=(votingData.Hispanic[y]*Math.pow(10,5))/total;//#111111
	pathWhite.push({x:yearScale(y),y: voteScale(white)});
	pathWhiteNH.push({x:yearScale(y),y: voteScale(whitenh)});
	pathBlack.push({x:yearScale(y),y: voteScale(black)});
	
	pathHispanic.push({x:yearScale(y),y: voteScale(hispanic)});

	svg.append("circle")
	.attr("r",4)
	.attr("cx",yearScale(y))
  	.attr("cy", voteScale(white))
  	.attr("fill","#113777");

  	svg.append("circle")
	.attr("r",4)
	.attr("cx",yearScale(y))
  	.attr("cy", voteScale(whitenh))
  	.attr("fill","#428ff4");

  	svg.append("circle")
	.attr("r",4)
	.attr("cx",yearScale(y))
  	.attr("cy", voteScale(black))
  	.attr("fill","#771616");
  	
  	if(asian!="(NA)"){
  	 svg.append("circle")
	.attr("r",4)
	.attr("cx",yearScale(y))
  	.attr("cy", voteScale(asian))
  	.attr("fill","#ba2121")
  	}

  	svg.append("circle")
	.attr("r",4)
	.attr("cx",yearScale(y))
  	.attr("cy", voteScale(hispanic))
  	.attr("fill","#111111");

  	
});
  var lineFunction = d3.line()
  .x(function(d) { return d.x; })
  .y(function(d) { return d.y; });


  svg.append("path")
  .attr("d", lineFunction(pathWhite))
  .attr("stroke", "#113777")
  .attr("stroke-width", 3)
  .attr("fill", "none");

  svg.append("path")
  .attr("d", lineFunction(pathWhiteNH))
  .attr("stroke", "#428ff4")
  .attr("stroke-width", 3)
  .attr("fill", "none");

  svg.append("path")
  .attr("d", lineFunction(pathBlack))
  .attr("stroke", "#771616")
  .attr("stroke-width", 3)
  .attr("fill", "none");

  svg.append("path")
  .attr("d", lineFunction(pathAsian))
  .attr("stroke", "#ba2121")
  .attr("stroke-width", 3)
  .attr("fill", "none");

  svg.append("path")
  .attr("d", lineFunction(pathHispanic))
  .attr("stroke", "#111111")
  .attr("stroke-width", 3)
  .attr("fill", "none");
  
  //legends
  var xLoc=850; var yLoc=110;
  svg.append("circle")
	.attr("r",6)
	.attr("cx",xLoc)
  	.attr("cy", yLoc)
  	.attr("fill","#113777");

  	svg.append("circle")
	.attr("r",6)
	.attr("cx",xLoc)
  	.attr("cy", yLoc+20)
  	.attr("fill","#428ff4");

  	svg.append("circle")
	.attr("r",6)
	.attr("cx",xLoc)
  	.attr("cy", yLoc+40)
  	.attr("fill","#771616");
  	
  	
  	svg.append("circle")
	.attr("r",6)
	.attr("cx",xLoc)
  	.attr("cy", yLoc+60)
  	.attr("fill","#ba2121")
  	

  	svg.append("circle")
	.attr("r",6)
	.attr("cx",xLoc)
  	.attr("cy", yLoc+80)
  	.attr("fill","#111111");

  	var pad=20; var ypad=6;
  	svg.append("text")
	.text("White Hispanic")
	.attr("x",xLoc+pad)
  	.attr("y", yLoc+ypad)
  	.attr("fill","black");

  	svg.append("text")
	.text("White Non-Hispanic")
	.attr("x",xLoc+pad)
  	.attr("y", yLoc+20+ypad)
  	.attr("fill","black");

  	svg.append("text")
	.text("Black")
	.attr("x",xLoc+pad)
  	.attr("y", yLoc+40+ypad)
  	.attr("fill","black");
  	
  	
  	svg.append("text")
	.text("Asian and Pacific Islander")
	.attr("x",xLoc+pad)
  	.attr("y", yLoc+60+ypad)
  	.attr("fill","black");
  	

  	svg.append("text")
	.text("Hispanic")
	.attr("x",xLoc+pad)
  	.attr("y", yLoc+80+ypad)
  	.attr("fill","black");
});





</script>


</html>
